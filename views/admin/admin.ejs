<html>
  <head>
    <title>Admin Page</title>
    <link rel="stylesheet" href="/styles/style1.css" />
    <link rel="stylesheet" href="/styles/bootstrap1.min.css" />
  </head>
  <body class="crm_body_bg">
    <nav class="sidebar">
      <div class="logo d-flex justify-content-between">
        <a href="index.html"><img src="../images/logo.jpg" alt /></a>
        <div class="sidebar_close_icon d-lg-none">
          <i class="ti-close"></i>
        </div>
      </div>
      <ul id="sidebar_menu">
        <li class="mm-active">
          <a class="has-arrow" href="#" aria-expanded="true">
            <img src="../images/menu-icon/1.svg" alt />
            <span>Dashboard</span>
          </a>
        </li>
        <li class>
          <a href="/admin/news.ejs">
            <img src="../images/menu-icon/2.svg" alt />
            <span>News</span>
          </a>
        </li>
        <li class>
          <a href="/admin/events.ejs">
            <img src="../images/time_15311293.png" style="max-width: 70%" alt />
            <span>Events</span>
          </a>
        </li>
        <li class>
          <a href="/admin/announcements.ejs">
            <img
              src="../images/marketing_12011138.png"
              style="max-width: 80%"
              alt
            />
            <span>Announcements</span>
          </a>
        </li>
        <li class>
          <a href="/admin/gallery.ejs">
            <img
              src="../images/image_12998520.png"
              style="max-width: 90%"
              alt
            />
            <span>Gallery</span>
          </a>
        </li>
        <li class>
          <a href="/admin/institution.ejs">
            <img
              src="../images/building_15624293.png"
              style="max-width: 90%"
              alt
            />
            <span>Institution</span>
          </a>
        </li>
        <li class>
          <a href="/admin/massTimings.ejs">
            <img src="../images/watch_2166542.png" style="max-width: 90%" alt />
            <span>Mass Timings</span>
          </a>
        </li>
        <li class>
          <a href="/admin/readings.ejs">
            <img
              src="../images/open-book_8132217.png"
              style="max-width: 80%"
              alt
            />
            <span>Readings</span>
          </a>
        </li>
        <li class>
          <a href="/admin/users.ejs">
            <img
              src="../images/community_16682249.png"
              style="max-width: 80%"
              alt
            />
            <span>Users</span>
          </a>
        </li>
      </ul>
    </nav>

    <section class="main_content dashboard_part">
      <div class="container-fluid g-0">
        <div class="row">
          <div class="col-lg-12 p-0">
            <div
              class="header_iner d-flex justify-content-between align-items-center"
            >
              <div class="sidebar_icon d-lg-none">
                <i class="ti-menu"></i>
              </div>
              <div>
                <form action="/admin/editChurchInfo.ejs">
                  <button
                    type="button"
                    class="btn btn-secondary btn-lg"
                    id="updateButton"
                  >
                    Update Church Info
                  </button>
                </form>
              </div>

              <div
                class="header_right d-flex justify-content-between align-items-center"
              >
                <div class="profile_info">
                  <img id="profileImage" src="" alt="Profile Image" />
                  <div class="profile_info_iner">
                    <p id="role">Welcome!</p>
                    <h5 id="name">User</h5>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="main_content_iner">
        <div class="container-fluid plr_30 body_white_bg pt_30">
          <div class="row justify-content-center">
            <div class="col-lg-12">
              <div class="single_element">
                <div class="quick_activity">
                  <div class="row">
                    <div class="col-12">
                      <div class="quick_activity_wrap">
                        <div class="single_quick_activity" id="wardsDiv">
                          <h3>Wards</h3>
                        </div>

                        <div class="single_quick_activity" id="priestsDiv">
                          <h3>Priests</h3>
                        </div>

                        <div class="single_quick_activity" id="associationsDiv">
                          <h3>Associations</h3>
                        </div>

                        <div class="single_quick_activity" id="obituaryDiv">
                          <h3>Obituary</h3>
                        </div>

                        <div
                          class="single_quick_activity"
                          id="parishCouncilDiv"
                        >
                          <h3>Parish Council</h3>
                        </div>

            </div>
            </div>
            </div>
            </div>
            </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </body>

    <script>
         document.addEventListener('DOMContentLoaded', () => {
    const userId = localStorage.getItem('userId'); 
    const token = localStorage.getItem('token');
    
    if (!token) {
        window.location.href = '/admin/login.ejs';
    } else if (userId) {
        fetch(`/app/user/read/${userId}`, {
          headers: {
            Authorization: `Bearer ${token}`,
          },
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById('profileImage').src = getImagePath(data.avatar); 
            document.getElementById('name').textContent = data.userName;
            
            document.getElementById('role').textContent = `Welcome ${data.role}!`;
        })
        .catch(error => console.error('Error fetching user details:', error));
    }
});
      

    function getImagePath(image) {
      if (image) {
        return image.replace("../../Church_portal/public/", "/");
      }
      return ""; // Return an empty string if the image is null or undefined
    }

    document.getElementById("wardsDiv").addEventListener("click", function () {
      window.location.href = "/admin/wards.ejs";
    });

    document
      .getElementById("priestsDiv")
      .addEventListener("click", function () {
        window.location.href = "/admin/priests.ejs";
      });

    document
      .getElementById("obituaryDiv")
      .addEventListener("click", function () {
        window.location.href = "/admin/obituary.ejs";
      });
    document
      .getElementById("associationsDiv")
      .addEventListener("click", function () {
        window.location.href = "/admin/associations.ejs";
      });
      document.getElementById('parishCouncilDiv').addEventListener('click', function() {
          window.location.href = '/admin/parishCouncil.ejs';
          
      });

      document.getElementById('updateButton').addEventListener('click', function() {
    window.location.href = '/admin/editChurchInfo.ejs';
});

   </script>



</html>
